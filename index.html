<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Emote Suche</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: #0f0f0f;
    color: #fff;
  }
  header {
    padding: 16px;
    position: sticky;
    top: 0;
    background: #0f0f0f;
    z-index: 10;
  }
  input {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 12px;
    padding: 16px;
  }
  .card {
    background: #1b1b1b;
    border-radius: 10px;
    padding: 8px;
    text-align: center;
    cursor: pointer;
  }
  .card img {
    max-width: 100%;
    height: auto;
  }
  .name {
    margin-top: 6px;
    font-size: 14px;
    word-break: break-word;
  }
  .toast {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #333;
    padding: 10px 16px;
    border-radius: 8px;
    opacity: 0;
    transition: opacity 0.2s;
  }
  .toast.show {
    opacity: 1;
  }
</style>
</head>
<body>

<header>
  <input id="search" placeholder="Tags suchen (z. B. katze, yoink)">
</header>

<div class="grid" id="grid"></div>
<div class="toast" id="toast">Kopiert</div>

<script>
const SHEET_ID = "1RvasLLCoS_XqJXmqr-HUsfY0ffpfRqPg7efCmSWLIYE";
const SHEET_NAME = "Emotes";
const FEED_URL = `https://opensheet.elk.sh/${SHEET_ID}/${encodeURIComponent(SHEET_NAME)}`;

let emotes = [];

fetch(FEED_URL)
  .then(r => r.json())
  .then(rows => {
    emotes = rows.map(r => ({
      name: r.emote_name,
      img: r.image_url,
      tags: (r.tags || "").toLowerCase()
    }));
    render(emotes);
  });

document.getElementById("search").addEventListener("input", e => {
  const q = e.target.value.toLowerCase().trim();
  if (!q) return render(emotes);

  const terms = q.split(",").map(t => t.trim()).filter(Boolean);
  const filtered = emotes.filter(e =>
    terms.every(t => e.tags.includes(t))
  );
  render(filtered);
});

function render(list) {
  const grid = document.getElementById("grid");
  grid.innerHTML = "";
  list.forEach(e => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <img src="${e.img}" alt="${e.name}">
      <div class="name">${e.name}</div>
    `;
    div.onclick = () => copy(e.name);
    grid.appendChild(div);
  });
}

function copy(text) {
  navigator.clipboard.writeText(text);
  const t = document.getElementById("toast");
  t.textContent = `"${text}" kopiert`;
  t.classList.add("show");
  setTimeout(() => t.classList.remove("show"), 1200);
}
</script>

</body>
</html>
